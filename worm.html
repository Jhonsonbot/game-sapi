<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Worm Clash</title>
  <link rel="stylesheet" href="worm.css" />

  <!-- ğŸ”Š Sound Assets -->
  <audio id="eatSound" src="assets/eat.wav" preload="auto"></audio>
  <audio id="deathSound" src="assets/death.wav" preload="auto"></audio>
  <audio id="boostSound" src="assets/bossBoost.wav" preload="auto"></audio>
  <audio id="bubbleSound" src="assets/bubble.wav" preload="auto"></audio>
</head>

<body>
  <div class="game-wrapper">

    <!-- ğŸ Main Menu -->
    <div id="menu" class="overlay">
      <h1 class="title">Worm Clash</h1>
      <p class="desc">Control your snake with your mouse and eat the colorful pellets to grow!</p>

      <input type="text" id="usernameInput" placeholder="Enter your username" maxlength="16" />
      <select id="patternSelect" style="margin-bottom: 1rem; padding: 0.5rem; border-radius: 6px;">
        <option value="default">ğŸ Default</option>
        <option value="random">ğŸ¨ Random</option>
        <option value="classic">ğŸŒ¿ Classic</option>
      </select>

      <button id="submitUsernameBtn">Submit</button>

      <ul class="tips">
        <li>ğŸ¯ Collect food to grow longer</li>
        <li>ğŸ Avoid hitting other snakes</li>
        <li>ğŸ† Reach the leaderboard!</li>
      </ul>

      <button id="startBtn" style="display: none;">Start Game</button>
    </div>

    <!-- ğŸ® Game Canvas -->
    <canvas id="gameCanvas"></canvas>

    <!-- ğŸ§¾ HUD -->
    <div id="hud" class="hud" style="display: none;">
      <button id="backToLobbyBtn">ğŸ¡ Menu</button>
      <div class="stat">ğŸ† <span id="score">0</span></div>
      <div class="stat">ğŸ Length: <span id="length">1</span></div>

      <!-- ğŸ”§ Lobby Menu (muncul setelah klik Menu) -->
      <div id="lobbyMenu" style="display: none; margin-top: 1rem;">
        <button id="leaderboardBtn">ğŸ† Top Scores</button>
        <button id="submitEmailBtn">ğŸ“§ Submit Email</button>
        <button id="resumeBtn">â–¶ï¸ Lanjut Main</button>
        <button id="restartBtnLobby">ğŸ” Restart Game</button>
      </div>
    </div>

    <!-- â˜ ï¸ Game Over -->
<div id="gameOver" class="overlay" style="display: none;">
  <h2 class="gameover-title">Game Over!</h2>
  <p class="final-score">Score: <span id="finalScore">0</span></p>
  <p class="final-length">Length: <span id="finalLength">0</span></p>

  <div class="btn-group">
    <button id="restartBtn">Play Again</button>
    <button id="menuBtn">Main Menu</button>
  </div>
</div>

<!-- ğŸ† Leaderboard -->
<div id="leaderboard" class="overlay" style="display: none;">
  <h2>ğŸ† Top 10 Leaderboard</h2>
  <ul id="leaderboardList"></ul>
  <button onclick="document.getElementById('leaderboard').style.display='none'">âŒ Close</button>
</div>
    
</div>
  <!-- ğŸ“œ Main Game Script -->
  <script type="module" src="worm.js"></script>

  <!-- ğŸ’¡ Lobby Menu Script -->
<script>
  const backToLobbyBtn = document.getElementById("backToLobbyBtn");
  const lobbyMenu = document.getElementById("lobbyMenu");
  const leaderboardEl = document.getElementById("leaderboard");

  backToLobbyBtn.addEventListener("click", () => {
    lobbyMenu.style.display = (lobbyMenu.style.display === "none" || lobbyMenu.style.display === "") 
      ? "block" 
      : "none";
  });

  document.getElementById("resumeBtn").addEventListener("click", () => {
    lobbyMenu.style.display = "none";
    if (typeof resumeGame === "function") resumeGame();
  });

  document.getElementById("restartBtnLobby").addEventListener("click", () => {
    if (typeof restartGame === "function") {
      restartGame();
    } else {
      location.reload();
    }
  });

  document.getElementById("leaderboardBtn").addEventListener("click", () => {
    leaderboardEl.style.display = 'block';
    if (typeof showLeaderboard === "function") showLeaderboard();
  });

  document.getElementById("menuBtn").addEventListener("click", () => {
    document.getElementById("gameOver").style.display = "none";
    document.getElementById("hud").style.display = "none";
    document.getElementById("menu").style.display = "flex";
  });

  document.getElementById("restartBtn").addEventListener("click", () => {
    if (typeof restartGame === "function") {
      restartGame();
    } else {
      location.reload();
    }
  });
</script>

</body>
</html>
